<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Bitcoin II — A Second Chance (Prototype Dashboard)</title>
  <meta name="description" content="Prototype dashboard for the Bitcoin II community with live CoinPaprika pricing, explorer stats, and official resource links." />
  <style>
    /* ----------------------
       Variables + base
       ----------------------*/
    :root{
      --bg:#020617;
      --panel:#071122;
      --muted:#8aa3b3;
      --accent:#00e0ff; /* neon cyan */
      --accent-2:#00c0d9;
      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(0,224,255,0.03);
      --radius:16px;
      --mono: 'SFMono-Regular', ui-monospace, SFMono, Menlo, Monaco, monospace;
      --ui-font: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;background:linear-gradient(180deg,var(--bg),#000012 60%);color:#dff6ff;font-family:var(--ui-font);margin:0}
    a{color:inherit;text-decoration:none}

    /* ----------------------
       Layout
       ----------------------*/
    .container{max-width:1200px;margin:36px auto;padding:28px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#00121b, #012233);display:inline-grid;place-items:center;box-shadow:0 6px 20px rgba(0,0,0,0.6),0 0 30px rgba(0,224,255,0.06) inset}
    .logo img{width:36px;height:36px;object-fit:contain;filter:drop-shadow(0 8px 18px rgba(0,224,255,0.08))}
    .brand h1{font-size:18px;margin:0;letter-spacing:1px}
    .brand p{margin:0;font-size:12px;color:var(--muted)}
    nav{display:flex;gap:18px;align-items:center}
    nav a{font-size:13px;color:var(--muted);text-decoration:none;padding:8px 10px;border-radius:8px}
    nav a:hover{color:var(--accent)}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));padding:10px 14px;border-radius:10px;color:#00121b;font-weight:700;box-shadow:0 6px 18px rgba(0,224,255,0.08);border:none}
    .login{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;color:var(--muted)}

    /* ----------------------
       Grid
       ----------------------*/
    .grid{display:grid;grid-template-columns:1fr 380px;gap:22px;margin-top:22px}

    /* ----------------------
       Hero / Card
       ----------------------*/
    .card{background:linear-gradient(180deg,var(--panel), rgba(5,20,30,0.6));border-radius:var(--radius);padding:28px;box-shadow:0 10px 30px rgba(0,0,0,0.5);border:1px solid rgba(0,224,255,0.03)}
    .hero{display:flex;gap:28px;align-items:center}
    .hero-left{flex:1}
    .h-title{font-size:44px;line-height:1;margin:0 0 12px;font-weight:700}
    .h-sub{color:var(--muted);margin:0 0 18px}
    .cta-row{display:flex;gap:12px;align-items:center}
    .cta-primary{background:var(--accent);color:#00121b;padding:12px 18px;border-radius:12px;font-weight:700}
    .cta-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px 14px;border-radius:10px;color:var(--muted)}

    /* 3D coin visualization placeholder */
    .coin-wrap{width:240px;height:240px;border-radius:20px;background:radial-gradient(ellipse at center, rgba(0,224,255,0.03), transparent 40%);display:grid;place-items:center;position:relative}
    .coin{width:160px;height:160px;border-radius:50%;background:conic-gradient(from 180deg,#001829, #003040);display:grid;place-items:center;box-shadow:0 8px 40px rgba(0,224,255,0.06),0 0 50px rgba(0,224,255,0.04) inset;border:1px solid rgba(0,224,255,0.12);transform:perspective(600px) rotateX(8deg)}
    .coin img{width:92px;height:92px;filter:drop-shadow(0 8px 18px rgba(0,224,255,0.08));}
    .coin-glow{position:absolute;inset:50% auto auto 50%;transform:translate(-50%,-60%);width:360px;height:360px;border-radius:999px;filter:blur(36px);background:radial-gradient(circle at 30% 40%, rgba(0,224,255,0.18), transparent 20%)}

    /* ----------------------
       Right column: widgets
       ----------------------*/
    .widgets{display:flex;flex-direction:column;gap:18px}
    .market{padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.015),transparent)}
    .price{display:flex;align-items:baseline;gap:12px}
    .price .value{font-size:28px;font-weight:700}
    .price .change{color:#8ee7b8;font-weight:700}
    .price .change.negative{color:#ff6b8a}
    .mini-chart{height:58px;background:linear-gradient(90deg,rgba(255,255,255,0.01),transparent);border-radius:8px;margin-top:12px}
    .market-details{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:16px;font-size:12px;color:var(--muted)}
    .market-details div{display:flex;flex-direction:column;gap:2px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
    .market-details dt{font-size:11px;text-transform:uppercase;letter-spacing:0.5px;color:rgba(223,246,255,0.65)}
    .market-details dd{margin:0;font-size:13px;color:#dff6ff;font-weight:600}
    .services{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
    .service{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;gap:12px;align-items:center}
    .service svg{width:28px;height:28px;opacity:0.95}
    .service h4{margin:0;font-size:13px}
    .muted{color:var(--muted)}

    /* ----------------------
       Lower sections
       ----------------------*/
    .lower-grid{display:grid;grid-template-columns:1fr 380px;gap:22px;margin-top:22px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
    .trade-controls{display:flex;gap:8px;align-items:center}
    .input, .select{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);color:inherit}
    .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));padding:10px 14px;border-radius:10px;border:none;font-weight:700}

    /* roadmap */
    .roadmap{display:flex;flex-direction:column;gap:12px}
    .mile{display:flex;gap:12px;align-items:flex-start}
    .dot{width:14px;height:14px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent-2));margin-top:6px;box-shadow:0 6px 16px rgba(0,224,255,0.06)}

    /* resources */
    .resource-section{margin-top:24px}
    .resource-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:16px}
    .resource-card{padding:16px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.015),transparent);border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:10px}
    .resource-card h4{margin:0;font-size:15px}
    .resource-card ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}
    .resource-card a{color:var(--muted);text-decoration:none;font-size:13px;display:inline-flex;align-items:center;gap:6px}
    .resource-card a:hover{color:var(--accent)}

    .block-list{list-style:none;padding:0;margin:12px 0 0;display:flex;flex-direction:column;gap:10px}
    .block-list li{padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);display:flex;justify-content:space-between;align-items:center;font-size:13px;color:var(--muted)}
    .block-list strong{font-size:14px;color:#dff6ff}
    .block-list span{display:block}
    .block-list a{color:inherit;text-decoration:none}
    .fundamentals{list-style:none;padding:0;margin:12px 0 0;display:flex;flex-direction:column;gap:10px}
    .fundamentals li{padding:12px;border-radius:12px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);color:#dff6ff}
    .fundamentals strong{display:block;font-size:13px;color:rgba(223,246,255,0.78);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px}

    footer{opacity:0.8;color:var(--muted);font-size:13px;margin-top:28px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.02)}

    /* small screens */
    @media (max-width:980px){
      .grid,.lower-grid{grid-template-columns:1fr}
      .widgets{order:2}
      .panel{min-height:0}
      .container{padding:18px}
      .h-title{font-size:34px}
      .coin-wrap{width:180px;height:180px}
    }

    /* subtle animations */
    @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
    .coin{animation:floaty 4.8s ease-in-out infinite}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <img src="Bitcoin2-logo-128.png" alt="" role="presentation">
        </div>
        <div>
          <h1>BC2</h1>
          <p>A second chance community chain</p>
        </div>
      </div>

      <nav>
        <a href="#features">Features</a>
        <a href="#tokenomics">Tokenomics</a>
        <a href="#roadmap">Roadmap</a>
        <a href="#resources">Resources</a>
        <button class="login">Log in</button>
        <button class="btn">Buy BC2</button>
      </nav>
    </header>

    <main>
      <div class="grid">
        <section class="card">
          <div class="hero">
            <div class="hero-left">
              <h2 class="h-title">Bitcoin II — a second chance for Satoshi's vision.</h2>
              <p class="h-sub">A proof-of-work sister chain with a brand new genesis block, mirroring Bitcoin's battle-tested design so everyday users can transact and mine from day one.</p>
              <div class="cta-row">
                <button class="cta-primary">Get started</button>
                <button class="cta-ghost">Explore docs</button>
              </div>

              <div style="display:flex;gap:18px;margin-top:18px;align-items:center">
                <div style="min-width:240px">
                  <h4 style="margin:0">Live market snapshot</h4>
                  <div class="price">
                    <div class="value" id="live-price">--</div>
                    <div class="change" id="live-change">--</div>
                  </div>
                  <div class="mini-chart" id="mini-chart" aria-hidden="true"></div>
                </div>
                <div style="flex:1">
                  <h4 style="margin:0">Network status</h4>
                  <p class="muted" style="margin:6px 0">Height: <strong id="height">--</strong> · Difficulty: <strong id="difficulty">--</strong></p>
                  <p class="muted" style="margin:6px 0">Last block: <strong id="last-block-time">--</strong></p>
                </div>
              </div>

            </div>

            <div class="coin-wrap" aria-hidden="true">
              <div class="coin" role="img" aria-label="BC2 coin">
                <img src="Bitcoin2-logo-128.png" alt="">
              </div>
              <div class="coin-glow"></div>
            </div>

          </div>

          <div style="display:flex;gap:18px;margin-top:18px;align-items:flex-start">
            <div style="flex:1">
              <h3 id="features">What Bitcoin II offers</h3>
              <ul class="muted">
                <li>Proof-of-Work security with the same SHA-256 algorithm trusted by Bitcoin.</li>
                <li>Fixed 21,000,000 BC2 supply and halving schedule every 210,000 blocks to preserve scarcity.</li>
                <li>Difficulty retargeting every 2,016 blocks to keep block production steady as hashrate shifts.</li>
                <li>A brand new genesis block so anyone can join from the beginning without legacy baggage.</li>
              </ul>
            </div>
            <aside style="width:200px">
              <h4>Quick links</h4>
              <ul class="muted" style="list-style:none;padding:0;margin:6px 0;display:flex;flex-direction:column;gap:6px">
                <li><a href="https://bitcoinii.space/" target="_blank" rel="noreferrer">Network Explorer</a></li>
                <li><a href="https://github.com/Bitcoin-II/BitcoinII-Core/releases" target="_blank" rel="noreferrer">Desktop Wallet</a></li>
                <li><a href="https://wallet-bc2.nitopool.fr/" target="_blank" rel="noreferrer">Web Wallet</a></li>
                <li><a href="https://bitcoin-ii.org/" target="_blank" rel="noreferrer">Official Site</a></li>
              </ul>
            </aside>
          </div>

        </section>

        <aside class="widgets">
          <div class="market card">
            <h4 style="margin:0 0 8px">Market data (CoinPaprika)</h4>
            <div class="price">
              <div class="value" id="side-price">--</div>
              <div class="change" id="side-change">--</div>
            </div>
            <div class="mini-chart" id="side-mini" aria-hidden="true"></div>
            <dl class="market-details">
              <div>
                <dt>24h volume</dt>
                <dd id="market-volume">--</dd>
              </div>
              <div>
                <dt>Market cap</dt>
                <dd id="market-cap">--</dd>
              </div>
              <div>
                <dt>7d change</dt>
                <dd id="market-change-7d">--</dd>
              </div>
              <div>
                <dt>Last updated</dt>
                <dd id="market-updated">--</dd>
              </div>
            </dl>

            <div class="services">
              <div class="service"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg><div><h4>Explorer</h4><div class="muted">bitcoinii.space live blocks</div></div></div>
              <div class="service"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 8V7a2 2 0 0 0-2-2h-3"/><path d="M3 12v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-6"/></svg><div><h4>Wallets</h4><div class="muted">Desktop, web & Android</div></div></div>
              <div class="service"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 6v6l4 2"/><path d="M20 21v-4a2 2 0 0 0-2-2h-4"/><path d="M4 15v4a2 2 0 0 0 2 2h4"/></svg><div><h4>Mining</h4><div class="muted">CPU friendly pools</div></div></div>
              <div class="service"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="7" r="4"/><path d="M5.5 21a6.5 6.5 0 0 1 13 0"/></svg><div><h4>Community</h4><div class="muted">Discord, Telegram, X</div></div></div>
            </div>

            </div>

          <div class="card panel" role="region" aria-labelledby="blocks">
            <h4 id="blocks" style="margin:0 0 8px">Latest blocks</h4>
            <ul class="block-list" id="block-list">
              <li><span>Loading recent blocks…</span></li>
            </ul>
            <a class="muted" style="display:inline-block;margin-top:12px" href="https://bitcoinii.space/" target="_blank" rel="noreferrer">Open full explorer</a>
          </div>

          <div class="card panel" role="region" aria-labelledby="trade">
            <h4 id="trade" style="margin:0 0 8px">Trade (simulation)</h4>
            <div class="trade-controls">
              <input class="input" type="text" value="0.01 BTC" aria-label="Amount" />
              <select class="select" aria-label="Action"><option>Buy</option><option>Sell</option></select>
              <button class="btn-primary">Place Order</button>
            </div>
            <p class="muted" style="margin-top:10px">Orders here are a UI mock — integrate with exchange or smart contracts for live trading.</p>
          </div>

        </aside>
      </div>

      <div class="lower-grid">
        <section class="panel card">
          <h3 id="tokenomics">Network fundamentals</h3>
          <p class="muted">Core parameters published on the official Bitcoin II launch site.</p>
          <ul class="fundamentals">
            <li><strong>Consensus</strong>Proof-of-Work secured by the SHA-256 hashing algorithm.</li>
            <li><strong>Max supply</strong>21,000,000 BC2 with the same halving cadence of every 210,000 blocks.</li>
            <li><strong>Difficulty retarget</strong>Adjusts every 2,016 blocks so block times remain consistent as hashrate changes.</li>
            <li><strong>Fresh genesis</strong>Bitcoin II starts from a brand new blockchain, giving miners an even playing field.</li>
            <li><strong>Mining accessibility</strong>Launch difficulty was reset to 1, making CPU mining viable for early supporters.</li>
          </ul>

          <p class="muted">Looking to mine? Recommended tooling includes Pooler's <code>cpuminer</code> with community pools listed below.</p>
        </section>

        <aside class="panel card">
          <h3 id="roadmap">Roadmap</h3>
          <div class="roadmap">
            <div class="mile"><div class="dot" aria-hidden></div><div><strong>Q1 — Mainnet alpha</strong><p class="muted">Consensus & gas optimizations</p></div></div>
            <div class="mile"><div class="dot"></div><div><strong>Q2 — Cross-chain bridges</strong><p class="muted">Secure bridging and liquidity</p></div></div>
            <div class="mile"><div class="dot"></div><div><strong>Q3 — Mobile wallet</strong><p class="muted">iOS & Android mobile wallet launch</p></div></div>
            <div class="mile"><div class="dot"></div><div><strong>Q4 — Governance</strong><p class="muted">On-chain DAO and staking v2</p></div></div>
          </div>
        </aside>
      </div>

      <section class="panel card resource-section" id="resources">
        <h3>BC2 ecosystem resources</h3>
        <p class="muted" style="margin:6px 0 14px">Explore official hubs, trading venues, wallets, and community channels for Bitcoin II.</p>
        <div class="resource-grid">
          <div class="resource-card">
            <h4>General</h4>
            <ul>
              <li><a href="https://bitcoin-ii.org/" target="_blank" rel="noreferrer">Official website</a></li>
              <li><a href="https://github.com/Bitcoin-II/BitcoinII-Core" target="_blank" rel="noreferrer">GitHub repository</a></li>
              <li><a href="https://bitcoinii.space/" target="_blank" rel="noreferrer">BC2 explorer</a></li>
              <li><a href="https://bitcoinii.ddns.net/NodeMap.html" target="_blank" rel="noreferrer">Node map</a></li>
              <li><a href="https://bitcoinii.ddns.net/DailyReport.html" target="_blank" rel="noreferrer">Daily network report</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <h4>Exchanges</h4>
            <ul>
              <li><a href="https://rabid-rabbit.org/account/trade/BC2-USDT" target="_blank" rel="noreferrer">Rabid Rabbit — BC2/USDT</a></li>
              <li><a href="https://trade.nestex.one/spot/BC2" target="_blank" rel="noreferrer">NestEX spot</a></li>
              <li><a href="https://klingex.io/trade/BC2-USDT" target="_blank" rel="noreferrer">Kling Exchange — BC2/USDT</a></li>
              <li><a href="https://nonkyc.io/market/BC2_USDT" target="_blank" rel="noreferrer">nonKYC market</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <h4>Wallets & tools</h4>
            <ul>
              <li><a href="https://github.com/Bitcoin-II/BitcoinII-Core/releases" target="_blank" rel="noreferrer">Core wallet (desktop)</a></li>
              <li><a href="https://wallet-bc2.nitopool.fr/" target="_blank" rel="noreferrer">Web wallet</a></li>
              <li><a href="https://play.google.com/store/apps/details?id=network.bitcoinii.bluewallet&hl=en_US" target="_blank" rel="noreferrer">Android wallet</a></li>
              <li><a href="https://www.livecoinwatch.com/price/BitcoinII-BC2" target="_blank" rel="noreferrer">LiveCoinWatch price</a></li>
              <li><a href="https://coinpaprika.com/coin/bc2-bitcoin-ii/" target="_blank" rel="noreferrer">CoinPaprika profile</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <h4>Mining</h4>
            <ul>
              <li><a href="https://miningpoolstats.stream/bitcoinii" target="_blank" rel="noreferrer">Mining Pool Stats</a></li>
            </ul>
          </div>
          <div class="resource-card">
            <h4>Community</h4>
            <ul>
              <li><a href="https://discord.gg/zUSkQHNVyG" target="_blank" rel="noreferrer">Discord</a></li>
              <li><a href="https://t.me/BitcoinIIOrganization" target="_blank" rel="noreferrer">Telegram</a></li>
              <li><a href="https://x.com/@TheBitcoinIIOrg" target="_blank" rel="noreferrer">X (Twitter)</a></li>
            </ul>
          </div>
        </div>
      </section>

      <footer>
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
          <div>© BC2 Protocol — Built with privacy-first design.</div>
          <div class="muted">Terms · Privacy · Docs · Contact</div>
        </div>
      </footer>
    </main>
  </div>

  <script>
    (function(){
      const priceEl = document.getElementById('live-price');
      const changeEl = document.getElementById('live-change');
      const sidePrice = document.getElementById('side-price');
      const sideChange = document.getElementById('side-change');
      const volumeEl = document.getElementById('market-volume');
      const capEl = document.getElementById('market-cap');
      const change7dEl = document.getElementById('market-change-7d');
      const updatedEl = document.getElementById('market-updated');
      const heightEl = document.getElementById('height');
      const difficultyEl = document.getElementById('difficulty');
      const lastBlockEl = document.getElementById('last-block-time');
      const blockList = document.getElementById('block-list');
      const chart = document.getElementById('mini-chart');
      const sideMini = document.getElementById('side-mini');

      const MARKET_ENDPOINT = 'https://api.coinpaprika.com/v1/tickers/bc2-bitcoin-ii';
      const BLOCKS_ENDPOINT = 'https://bitcoinii.space/api/blocks?limit=5';
      let historyLoaded = false;

      function renderSpark(el, series){
        if(!el || !Array.isArray(series) || series.length < 2) return;
        const w=200,h=60;
        const min=Math.min(...series), max=Math.max(...series);
        const norm=v=> ((v-min)/(max-min||1))*(h-6) + 3;
        const step=w/(series.length-1);
        let d='M0 '+(h - norm(series[0]));
        for(let i=1;i<series.length;i++) d += ' L '+(i*step)+' '+(h - norm(series[i]));
        const svg = `<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}" xmlns="http://www.w3.org/2000/svg"><path d="${d}" fill="none" stroke="url(#g)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#00e0ff" stop-opacity="0.95"/><stop offset="1" stop-color="#00bcd7" stop-opacity="0.95"/></linearGradient></defs></svg>`;
        el.innerHTML = svg;
      }

      function formatCurrency(value){
        if(value === null || value === undefined || Number.isNaN(Number(value))) return '—';
        const num = Number(value);
        const opts = {maximumFractionDigits: num < 1 ? 6 : 2};
        return '$'+num.toLocaleString(undefined, opts);
      }

      function formatPercent(value){
        if(value === null || value === undefined || Number.isNaN(Number(value))) return '—';
        const num = Number(value);
        const prefix = num > 0 ? '+' : '';
        return prefix + num.toFixed(2) + '%';
      }

      function applyChange(el, value){
        if(!el) return;
        if(value === null || value === undefined || Number.isNaN(Number(value))){
          el.textContent = '—';
          el.classList.remove('negative');
          return;
        }
        const num = Number(value);
        el.textContent = formatPercent(num);
        if(num < 0){
          el.classList.add('negative');
        }else{
          el.classList.remove('negative');
        }
      }

      function formatNumber(value, options){
        if(value === null || value === undefined || Number.isNaN(Number(value))) return '—';
        return Number(value).toLocaleString(undefined, options);
      }

      function formatSize(bytes){
        if(bytes === null || bytes === undefined || Number.isNaN(Number(bytes))) return '—';
        const num = Number(bytes);
        if(num < 1024) return `${num} B`;
        return (num/1024).toFixed(1) + ' kB';
      }

      const rtf = typeof Intl !== 'undefined' && Intl.RelativeTimeFormat ? new Intl.RelativeTimeFormat(undefined, {numeric:'auto'}) : null;
      function formatTimeAgo(date){
        if(!(date instanceof Date) || Number.isNaN(date.getTime())) return '—';
        const diff = Date.now() - date.getTime();
        const table = [
          ['day', 86400000],
          ['hour', 3600000],
          ['minute', 60000],
          ['second', 1000]
        ];
        for(const [unit, ms] of table){
          const value = Math.round(diff/ms);
          if(Math.abs(value) >= 1 || unit === 'second'){
            return rtf ? rtf.format(-value, unit) : `${Math.abs(value)} ${unit}${Math.abs(value) === 1 ? '' : 's'} ago`;
          }
        }
        return 'just now';
      }

      async function updateHistory(){
        try{
          const start = new Date(Date.now() - 48*60*60*1000).toISOString().split('T')[0];
          const historyUrl = `${MARKET_ENDPOINT}/historical?start=${start}&interval=1h`;
          const response = await fetch(historyUrl, {cache:'no-store'});
          if(!response.ok) throw new Error(`History status ${response.status}`);
          const history = await response.json();
          if(!Array.isArray(history) || history.length === 0) return;
          const series = history.map(point => Number(point.price)).filter(num => !Number.isNaN(num));
          if(series.length < 2) return;
          renderSpark(chart, series);
          renderSpark(sideMini, series);
          historyLoaded = true;
        }catch(err){
          console.warn('Unable to load BC2 history', err);
        }
      }

      async function updateMarket(){
        try{
          const response = await fetch(MARKET_ENDPOINT, {cache:'no-store'});
          if(!response.ok) throw new Error(`Status ${response.status}`);
          const data = await response.json();
          const usd = data && data.quotes && data.quotes.USD;
          if(!usd) throw new Error('Missing USD quote');

          priceEl.textContent = formatCurrency(usd.price);
          sidePrice.textContent = priceEl.textContent;
          applyChange(changeEl, usd.percent_change_24h);
          applyChange(sideChange, usd.percent_change_24h);
          volumeEl.textContent = formatCurrency(usd.volume_24h);
          capEl.textContent = usd.market_cap ? formatCurrency(usd.market_cap) : '—';
          change7dEl.textContent = formatPercent(usd.percent_change_7d);
          const updated = data.last_updated ? new Date(data.last_updated) : new Date();
          updatedEl.textContent = updated.toLocaleString();

          if(!historyLoaded){
            updateHistory();
          }
        }catch(err){
          console.warn('Unable to load BC2 market data', err);
          priceEl.textContent = sidePrice.textContent = '—';
          changeEl.textContent = sideChange.textContent = '—';
          volumeEl.textContent = capEl.textContent = change7dEl.textContent = '—';
        }
      }

      async function updateBlocks(){
        try{
          const response = await fetch(BLOCKS_ENDPOINT, {cache:'no-store'});
          if(!response.ok) throw new Error(`Status ${response.status}`);
          const blocks = await response.json();
          if(!Array.isArray(blocks) || blocks.length === 0) throw new Error('No blocks returned');
          const latest = blocks[0];
          heightEl.textContent = formatNumber(latest.height);
          difficultyEl.textContent = formatNumber(latest.difficulty, {maximumFractionDigits:2});
          lastBlockEl.textContent = formatTimeAgo(new Date(latest.timestamp * 1000));

          blockList.innerHTML = blocks.map(block => {
            const blockTime = new Date(block.timestamp * 1000);
            const height = formatNumber(block.height);
            const txLabel = `${block.tx_count} tx`;
            const sizeLabel = formatSize(block.size);
            return `<li><div><strong><a href="https://bitcoinii.space/block/${block.id}" target="_blank" rel="noreferrer">#${height}</a></strong><span>${formatTimeAgo(blockTime)}</span></div><div style="text-align:right"><span>${txLabel}</span><span>${sizeLabel}</span></div></li>`;
          }).join('');
        }catch(err){
          console.warn('Unable to load BC2 blocks', err);
          blockList.innerHTML = '<li><span>Unable to load blocks. Visit the explorer for the latest data.</span></li>';
        }
      }

      updateMarket();
      updateBlocks();
      setInterval(updateMarket, 60000);
      setInterval(updateBlocks, 45000);

      document.addEventListener('keydown', function(e){ if(e.key==='Tab') document.body.classList.add('show-focus'); });
    })();
  </script>
</body>
</html>

